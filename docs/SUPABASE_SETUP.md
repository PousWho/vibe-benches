# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase (–≠—Ç–∞–ø 1 ‚Äî –±—ç–∫–µ–Ω–¥)

–ó–¥–µ—Å—å –ø–æ —à–∞–≥–∞–º: –∫–∞–∫ –ø–æ–¥–Ω—è—Ç—å –±–∞–∑—É –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç.

## 1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Supabase

1. –ó–∞–π–¥–∏ –Ω–∞ [supabase.com](https://supabase.com) –∏ –≤–æ–π–¥–∏ (–∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è).
2. **New project** ‚Üí –≤—ã–±–µ—Ä–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é, –≤–≤–µ–¥–∏ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä `vibe-benches`), –ø–∞—Ä–æ–ª—å –ë–î, —Ä–µ–≥–∏–æ–Ω.
3. –î–æ–∂–¥–∏—Å—å —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (1‚Äì2 –º–∏–Ω—É—Ç—ã).

## 2. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `benches`

1. –í –ø—Ä–æ–µ–∫—Ç–µ –æ—Ç–∫—Ä–æ–π **SQL Editor** (—Å–ª–µ–≤–∞ –≤ –º–µ–Ω—é).
2. –ù–∞–∂–º–∏ **New query**.
3. –°–∫–æ–ø–∏—Ä—É–π –∏ –≤—Å—Ç–∞–≤—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `supabase/migrations/001_create_benches.sql` –∏–∑ —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
4. –ù–∞–∂–º–∏ **Run** (–∏–ª–∏ Ctrl+Enter). –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏.

–¢–∞–∫ –º—ã —Å–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É –∏ –ø–æ–ª–∏—Ç–∏–∫–∏ RLS: –∫—Ç–æ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –ª–∞–≤–æ—á–∫–∏.

**–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `benches` —É —Ç–µ–±—è —É–∂–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ —Ä–∞–Ω—å—à–µ (–±–µ–∑ –∫–æ–ª–æ–Ω–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏):** –≤—ã–ø–æ–ª–Ω–∏ –µ—â—ë —Ä–∞–∑ –≤ SQL Editor —Å–∫—Ä–∏–ø—Ç `supabase/migrations/002_add_bench_category.sql` ‚Äî –æ–Ω –¥–æ–±–∞–≤–∏—Ç –∫–æ–ª–æ–Ω–∫—É `category`.

## 3. –í–∑—è—Ç—å –∫–ª—é—á–∏ –∏ URL

1. –í –ø—Ä–æ–µ–∫—Ç–µ –æ—Ç–∫—Ä–æ–π **Settings** (–∏–∫–æ–Ω–∫–∞ —à–µ—Å—Ç–µ—Ä—ë–Ω–∫–∏) ‚Üí **API**.
2. –°–∫–æ–ø–∏—Ä—É–π **—Ç–æ–ª—å–∫–æ**:
   - **Project URL** ‚Üí —ç—Ç–æ `NEXT_PUBLIC_SUPABASE_URL`
   - **anon public** (–ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ —Ä–∞–∑–¥–µ–ª–µ Project API keys) ‚Üí —ç—Ç–æ `NEXT_PUBLIC_SUPABASE_ANON_KEY`
   - **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π** –∫–ª—é—á **service_role** / secret –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ‚Äî –≤ –±—Ä–∞—É–∑–µ—Ä–µ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ ¬´Forbidden use of secret API key¬ª. –û–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å –ø–æ–ª–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º.

## 4. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç

1. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π –∏–ª–∏ –æ—Ç–∫—Ä–æ–π —Ñ–∞–π–ª `.env.local`.
2. –î–æ–±–∞–≤—å (–ø–æ–¥—Å—Ç–∞–≤—å —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è):

```env
NEXT_PUBLIC_MAPBOX_TOKEN=—Ç–≤–æ–π_—Ç–æ–∫–µ–Ω_mapbox
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=—Ç–≤–æ–π_anon_key
```

3. –°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª. `.env.local` –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ Git ‚Äî —Å–µ–∫—Ä–µ—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ.

## 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ dev-—Å–µ—Ä–≤–µ—Ä: `npm run dev`.
2. –û—Ç–∫—Ä–æ–π [http://localhost:3000/map](http://localhost:3000/map).
3. –ï—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞—è ‚Äî –º–∞—Ä–∫–µ—Ä–æ–≤ –Ω–µ –±—É–¥–µ—Ç, –Ω–æ –Ω–∞–¥–ø–∏—Å—å ¬´–ö–∞—Ä—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞¬ª –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–∫–∏ ¬´–õ–∞–≤–æ—á–∫–∏: ‚Ä¶¬ª –æ–∑–Ω–∞—á–∞—é—Ç, —á—Ç–æ API –∏ Supabase —Ä–∞–±–æ—Ç–∞—é—Ç.

### –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –ª–∞–≤–æ—á–∫—É —á–µ—Ä–µ–∑ Supabase

–í **SQL Editor** –≤—ã–ø–æ–ª–Ω–∏ (–ø–æ–¥—Å—Ç–∞–≤—å —Å–≤–æ–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏):

–ö–∞—Ç–µ–≥–æ—Ä–∏–∏: `mountain`, `forest`, `city`, `beach`, `other`.

```sql
INSERT INTO public.benches (title, description, lat, lng, category, accessibility, crowd, view, vibe)
VALUES (
  '–õ–∞–≤–∫–∞ —Å –≤–∏–¥–æ–º –Ω–∞ –∑–∞–∫–∞—Ç',
  '–û—á–µ–Ω—å –≤–∞–π–±–æ–≤–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –≤–µ—á–µ—Ä–æ–º üåÖ',
  42.4309,
  19.2625,
  'mountain',
  4, 2, 5, 5
);
```

–û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–∞—Ä—Ç—ã ‚Äî –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –º–∞—Ä–∫–µ—Ä.

---

## –≠—Ç–∞–ø 3 ‚Äî –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ß—Ç–æ–±—ã —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥–ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å –ª–∞–≤–æ—á–∫–∏ –∏ —á—Ç–æ–±—ã –ª–∞–≤–æ—á–∫–∞ –±—ã–ª–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –≤–ª–∞–¥–µ–ª—å—Ü—É:

1. –í Supabase –≤–∫–ª—é—á–µ–Ω–∞ **Authentication** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —É–∂–µ –≤–∫–ª—é—á–µ–Ω–∞). –í **Authentication ‚Üí Providers** –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å Email.
2. –í **SQL Editor** –≤—ã–ø–æ–ª–Ω–∏ —Å–∫—Ä–∏–ø—Ç `supabase/migrations/003_benches_user_id.sql`: –¥–æ–±–∞–≤–∏—Ç—Å—è –∫–æ–ª–æ–Ω–∫–∞ `user_id`, –ø–æ–ª–∏—Ç–∏–∫–∏ RLS –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ (INSERT/UPDATE/DELETE —Ç–æ–ª—å–∫–æ —Å–æ —Å–≤–æ–∏–º `user_id`).
3. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –Ω–∞ –∫–∞—Ä—Ç–µ –∫–Ω–æ–ø–∫–∞ **¬´–í–æ–π—Ç–∏¬ª**; –ø–æ –∫–ª–∏–∫—É –ø–æ –∫–∞—Ä—Ç–µ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª–∫–∞ –≤—Ö–æ–¥–∞. –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ª–∞–≤–æ—á–∫–∏; –≤ –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–≤–æ–π `user_id`.

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è 003 –¥–æ–±–∞–≤–ª—è—Ç—å –ª–∞–≤–æ—á–∫–∏ —á–µ—Ä–µ–∑ SQL Editor –æ—Ç –∏–º–µ–Ω–∏ ¬´–∞–Ω–æ–Ω–∏–º–∞¬ª –Ω–µ–ª—å–∑—è ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é.

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è:** –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –µ—Å—Ç—å ¬´–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?¬ª ‚Üí –ø–∏—Å—å–º–æ —Å–æ —Å—Å—ã–ª–∫–æ–π. –ß—Ç–æ–±—ã —Å—Å—ã–ª–∫–∞ –≤–µ–ª–∞ –Ω–∞ –Ω–∞—à —Å–∞–π—Ç, –≤ Supabase –æ—Ç–∫—Ä–æ–π **Authentication ‚Üí URL Configuration** –∏ –≤ **Redirect URLs** –¥–æ–±–∞–≤—å –∞–¥—Ä–µ—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–±—Ä–æ—Å–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä `http://localhost:3000/auth/callback` –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ `https://—Ç–≤–æ–π-–¥–æ–º–µ–Ω.ru/auth/callback` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.

### –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∏–º—è, —Å—Ç—Ä–∞–Ω–∞, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)

–ß—Ç–æ–±—ã –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–º—è, —Å—Ç—Ä–∞–Ω—É –∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ö –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ—Ñ–∏–ª—è:

1. –í **SQL Editor** –≤—ã–ø–æ–ª–Ω–∏ —Å–∫—Ä–∏–ø—Ç `supabase/migrations/004_create_profiles.sql` ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ `profiles` –∏ –ø–æ–ª–∏—Ç–∏–∫–∏ RLS (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ—é —Å—Ç—Ä–æ–∫—É).
